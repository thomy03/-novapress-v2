# NovaPress AI v2 - Architecture Backend

## Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NOVAPRESS AI V2 BACKEND                      â”‚
â”‚                   100% OPEN SOURCE - NO GEMINI                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (Next.js)                        â”‚
â”‚  HTTP/REST API  â”‚  WebSocket  â”‚  Recherche SÃ©mantique          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FASTAPI BACKEND                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Articles   â”‚  â”‚ Search     â”‚  â”‚ Trending   â”‚  â”‚ WebSocket  â”‚â”‚
â”‚  â”‚ API        â”‚  â”‚ API        â”‚  â”‚ API        â”‚  â”‚ Real-time  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICES LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              PIPELINE ENGINE V3                             â”‚ â”‚
â”‚  â”‚  1. Scraping â†’ 2. Embeddings â†’ 3. Clustering â†’             â”‚ â”‚
â”‚  â”‚  4. Knowledge Graph â†’ 5. Synthesis â†’ 6. Storage            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Scraper    â”‚  â”‚   Pipeline   â”‚  â”‚   Utils      â”‚         â”‚
â”‚  â”‚   Service    â”‚  â”‚   Service    â”‚  â”‚   Service    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ML/AI LAYER                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   BGE-M3     â”‚  â”‚    Ollama    â”‚  â”‚   HDBSCAN    â”‚         â”‚
â”‚  â”‚  Embeddings  â”‚  â”‚   Mistral    â”‚  â”‚  Clustering  â”‚         â”‚
â”‚  â”‚  1024-dim    â”‚  â”‚   7B LLM     â”‚  â”‚   Density    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚    spaCy     â”‚  â”‚   NetworkX   â”‚                            â”‚
â”‚  â”‚     NER      â”‚  â”‚  Graph AI    â”‚                            â”‚
â”‚  â”‚  fr_core_lg  â”‚  â”‚   Analysis   â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  PostgreSQL  â”‚  â”‚    Qdrant    â”‚  â”‚    Redis     â”‚         â”‚
â”‚  â”‚   Articles   â”‚  â”‚   Vectors    â”‚  â”‚    Cache     â”‚         â”‚
â”‚  â”‚  Metadata    â”‚  â”‚  Similarity  â”‚  â”‚   Sessions   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flux de DonnÃ©es - Pipeline V3

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ã‰TAPE 1: COLLECTE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RSS Feeds        Google News RSS        Simulation              â”‚
â”‚  Le Monde â”€â”€â”€â”    â”Œâ”€ Scraping         â”Œâ”€ Mock Data              â”‚
â”‚  Le Figaro   â”œâ”€â”€â”€â”€â”¤  Google News â”€â”€â”€â”€â”€â”¤                         â”‚
â”‚  AFP         â”‚    â””â”€ No API Key       â””â”€ Testing                â”‚
â”‚  Reuters â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                         â†“                                         â”‚
â”‚              [ Raw Articles: ~100 items ]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Ã‰TAPE 2: VECTORISATION                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              BGE-M3 Embeddings (BAAI)                            â”‚
â”‚       "Article title + summary" â†’ [1024 floats]                  â”‚
â”‚                                                                  â”‚
â”‚  Batch Processing: 32 articles/s                                â”‚
â”‚  Normalization: L2 (for cosine similarity)                      â”‚
â”‚                         â†“                                        â”‚
â”‚         [ Embeddings Matrix: (100, 1024) ]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Ã‰TAPE 3: CLUSTERING                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   HDBSCAN Algorithm                              â”‚
â”‚  - Density-based clustering                                      â”‚
â”‚  - Automatic cluster detection                                   â”‚
â”‚  - Noise filtering (outliers)                                    â”‚
â”‚                         â†“                                        â”‚
â”‚         [ Clusters: ~8 thematic groups ]                        â”‚
â”‚  Cluster 0: IA (15 articles)                                    â”‚
â”‚  Cluster 1: Ã‰conomie (12 articles)                              â”‚
â”‚  Cluster 2: GÃ©opolitique (8 articles)                           â”‚
â”‚  ...                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Ã‰TAPE 4: KNOWLEDGE GRAPH                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              spaCy NER + NetworkX                                â”‚
â”‚                                                                  â”‚
â”‚  Named Entity Recognition:                                       â”‚
â”‚    - Organizations (ORG)                                         â”‚
â”‚    - Persons (PERSON)                                            â”‚
â”‚    - Locations (GPE, LOC)                                        â”‚
â”‚    - Events                                                      â”‚
â”‚                         â†“                                        â”‚
â”‚  Graph Construction:                                             â”‚
â”‚    Nodes: Top 50 entities                                        â”‚
â”‚    Edges: Co-occurrence relations                                â”‚
â”‚    Weights: Frequency                                            â”‚
â”‚                         â†“                                        â”‚
â”‚  [ Knowledge Graph: 50 nodes, 100 edges ]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Ã‰TAPE 5: SYNTHÃˆSE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Ollama + Mistral 7B Instruct                           â”‚
â”‚                                                                  â”‚
â”‚  For each cluster (top 5):                                       â”‚
â”‚    1. Aggregate source articles                                  â”‚
â”‚    2. Generate synthesis prompt                                  â”‚
â”‚    3. Call Mistral LLM                                           â”‚
â”‚    4. Extract JSON response                                      â”‚
â”‚                         â†“                                        â”‚
â”‚  Synthesis Output:                                               â”‚
â”‚    - Title (accrocheur)                                          â”‚
â”‚    - Summary (100-150 words)                                     â”‚
â”‚    - Key Points (3-5 bullets)                                    â”‚
â”‚    - Compliance Score (0-100)                                    â”‚
â”‚                         â†“                                        â”‚
â”‚  [ 5 AI-Generated Syntheses ]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Ã‰TAPE 6: STOCKAGE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Qdrant (Vector DB)         PostgreSQL           Redis           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€          â”‚
â”‚  - Article embeddings        - Metadata          - Cache         â”‚
â”‚  - Similarity search         - Users             - Sessions      â”‚
â”‚  - Related articles          - Stats             - Jobs          â”‚
â”‚                         â†“                                        â”‚
â”‚           [ Articles Ready for Frontend ]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Fichiers

```
backend/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                    # ğŸš€ FastAPI entrypoint
â”‚   â”‚                               # - Lifespan events
â”‚   â”‚                               # - CORS middleware
â”‚   â”‚                               # - Routes registration
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ config.py              # âš™ï¸ Settings (pydantic)
â”‚   â”‚                               # - Environment variables
â”‚   â”‚                               # - Database URLs
â”‚   â”‚                               # - ML model configs
â”‚   â”‚
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â”œâ”€â”€ articles.py        # ğŸ“° Articles CRUD
â”‚   â”‚       â”‚                       # GET /api/articles
â”‚   â”‚       â”‚                       # GET /api/articles/{id}
â”‚   â”‚       â”‚                       # GET /api/articles/{id}/related
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ search.py          # ğŸ” Semantic Search
â”‚   â”‚       â”‚                       # GET /api/search?q=...
â”‚   â”‚       â”‚                       # BGE-M3 embeddings
â”‚   â”‚       â”‚                       # Qdrant similarity
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ trending.py        # ğŸ“Š Trending Topics
â”‚   â”‚       â”‚                       # GET /api/trending
â”‚   â”‚       â”‚                       # GET /api/trending/{id}/synthesis
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ auth.py            # ğŸ” Authentication
â”‚   â”‚       â”‚                       # POST /api/auth/login
â”‚   â”‚       â”‚                       # POST /api/auth/register
â”‚   â”‚       â”‚                       # GET /api/auth/profile
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ websocket.py       # ğŸ”„ Real-time
â”‚   â”‚                               # WS /ws/updates
â”‚   â”‚                               # Breaking news
â”‚   â”‚                               # Trending updates
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ session.py             # ğŸ—„ï¸ PostgreSQL
â”‚   â”‚   â”‚                           # Async SQLAlchemy
â”‚   â”‚   â”‚                           # Session factory
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ qdrant_client.py       # ğŸ” Qdrant Vector DB
â”‚   â”‚                               # Upsert embeddings
â”‚   â”‚                               # Similarity search
â”‚   â”‚
â”‚   â”œâ”€â”€ ml/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ embeddings.py          # ğŸ§® BGE-M3
â”‚   â”‚   â”‚                           # BAAI/bge-m3
â”‚   â”‚   â”‚                           # 1024-dim embeddings
â”‚   â”‚   â”‚                           # Batch encoding
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ llm.py                 # ğŸ§  Ollama/Mistral
â”‚   â”‚   â”‚                           # Local LLM
â”‚   â”‚   â”‚                           # Text generation
â”‚   â”‚   â”‚                           # JSON generation
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ clustering.py          # ğŸ”— HDBSCAN
â”‚   â”‚   â”‚                           # Density clustering
â”‚   â”‚   â”‚                           # Auto cluster detection
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ knowledge_graph.py     # ğŸ•¸ï¸ spaCy + NetworkX
â”‚   â”‚                               # Named Entity Recognition
â”‚   â”‚                               # Graph construction
â”‚   â”‚                               # Centrality analysis
â”‚   â”‚
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ scraper.py             # ğŸ“¡ Web Scraping
â”‚       â”‚                           # RSS feeds
â”‚       â”‚                           # Google News RSS
â”‚       â”‚                           # Newspaper3k
â”‚       â”‚
â”‚       â””â”€â”€ pipeline.py            # âš™ï¸ Pipeline Engine
â”‚                                   # Orchestration
â”‚                                   # 6 steps execution
â”‚
â”œâ”€â”€ docker-compose.yml              # ğŸ³ Services orchestration
â”‚                                   # - postgres
â”‚                                   # - redis
â”‚                                   # - qdrant
â”‚                                   # - ollama
â”‚                                   # - backend
â”‚
â”œâ”€â”€ Dockerfile                      # ğŸ“¦ Backend image
â”œâ”€â”€ requirements.txt                # ğŸ“š Python dependencies
â”œâ”€â”€ .env.example                    # âš™ï¸ Config template
â”‚
â”œâ”€â”€ start.sh                        # ğŸš€ Quick start (Linux/Mac)
â”œâ”€â”€ start.ps1                       # ğŸš€ Quick start (Windows)
â”‚
â”œâ”€â”€ README.md                       # ğŸ“– Main documentation
â”œâ”€â”€ MIGRATION.md                    # ğŸ”„ Gemini â†’ Open Source
â””â”€â”€ INTEGRATION.md                  # ğŸ”Œ Frontend integration
```

---

## Comparaison: Gemini vs Open Source

| FonctionnalitÃ© | Ancien (Gemini) | Nouveau (Open Source) |
|----------------|-----------------|------------------------|
| **Embeddings** | Google Embeddings API | BGE-M3 (BAAI/bge-m3) |
| Dimension | 768 | 1024 |
| Latence | ~200ms (network) | ~50ms (local) |
| CoÃ»t/1M | $0.025 | $0 |
| | | |
| **LLM** | Gemini 2.5 Flash | Ollama + Mistral 7B |
| Context | 32k tokens | 8k tokens |
| Latence | ~500ms | ~5s |
| CoÃ»t/1M tokens | $0.50 | $0 |
| | | |
| **NER** | Gemini Prompt | spaCy fr_core_news_lg |
| Accuracy | ~85% | ~92% (French) |
| Latence | ~300ms | ~100ms |
| | | |
| **Scraping** | Google Search Grounding | RSS + Google News RSS |
| API Key | Required | Not required |
| Rate Limits | Oui | Non |
| | | |
| **Total CoÃ»t/mois** | ~$95 | ~$30 (infra only) |
| **ConfidentialitÃ©** | âŒ DonnÃ©es Google | âœ… 100% local |
| **Performance** | âš ï¸ Network dependent | âœ… Local speed |

---

## Ports & Services

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service        â”‚  Port   â”‚  Description                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Backend API    â”‚  5000   â”‚  FastAPI REST + WebSocket        â”‚
â”‚  API Docs       â”‚  5000   â”‚  /api/docs (Swagger UI)          â”‚
â”‚  PostgreSQL     â”‚  5432   â”‚  Relational database             â”‚
â”‚  Redis          â”‚  6379   â”‚  Cache + sessions                â”‚
â”‚  Qdrant         â”‚  6333   â”‚  Vector database                 â”‚
â”‚  Qdrant gRPC    â”‚  6334   â”‚  gRPC interface                  â”‚
â”‚  Ollama         â”‚  11434  â”‚  LLM API                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Technologies ClÃ©s

### BGE-M3 (BAAI)
- **Type:** Multilingual embedding model
- **Dimension:** 1024
- **Languages:** 100+ (including French)
- **Performance:** State-of-the-art retrieval
- **License:** MIT

### Ollama + Mistral 7B
- **Type:** Local LLM inference
- **Model:** Mistral 7B Instruct
- **Context:** 8k tokens
- **Speed:** ~20 tokens/s (CPU), ~100 tokens/s (GPU)
- **License:** Apache 2.0

### HDBSCAN
- **Type:** Density-based clustering
- **Advantages:** Auto-detect clusters, handles noise
- **Performance:** O(n log n)

### spaCy
- **Model:** fr_core_news_lg
- **Accuracy:** 92.4% (French NER)
- **Speed:** ~10k words/s

### Qdrant
- **Type:** Vector database
- **Index:** HNSW
- **Speed:** <10ms search
- **Scalability:** Billions of vectors

---

**NovaPress AI v2 Backend - Architecture ComplÃ¨te** ğŸ—ï¸
